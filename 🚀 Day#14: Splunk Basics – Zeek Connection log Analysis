ðŸš€Day#14/ Splunk Basics â€“ Zeek Connection Log Analysis


ðŸŽ¯ Objective

In this lab will Learn how to upload and search Zeek connection logs in Splunk.
Find top clients, top servers, and most common services.
Identify large traffic and long connections.

ðŸ–¥ï¸ Lab Setup

âœ… Splunk: Already installed and accessible.
âœ… Data Source: JSON-formatted Zeek-style connection logs.
ðŸŒ Log File: Download and upload to Splunk using the steps below.

	â€¢	âœ…Software Status: Splunk is installed and accessible.
	â€¢	âœ…Data Source: JSON-formatted Zeek-style connection logs.
	â€¢	ðŸŒLog File: Needs to be downloaded and uploaded to Splunk.

ðŸ“¥ Download Zeek Conn Log File

âš™ï¸ Steps to Upload Conn Log into Splunk

Go to Splunk Web â†’ Settings > Add Data.
Choose Upload and select zeek_conn_logs.json.
Set Source type: json or create a new one like zeek:conn.
Index: Use main or create a new one called conn_lab.
Complete the upload and check that logs are searchable.

ðŸ” Lab Tasks

Use the following SPL queries to complete each task:

âœ…Task 1: Find the Top 10 Client IPs (id.orig_h)

index=conn_lab sourcetype="json"
| stats count by id.orig_h
| sort -count
| head 10
âœ…Task 2: List Most Common Services

index=conn_lab sourcetype="json"
| stats count by service
| sort -count
âœ…Task 3: Find Connections with Duration > 1 Second

index=conn_lab sourcetype="json" duration>1
| table ts id.orig_h id.resp_h service duration
| sort -duration
âœ…Task 4: Identify the Most Accessed Internal Servers

index=conn_lab sourcetype="json"
| stats count by "id.resp_h"
| sort -count
| head 10
ðŸ“¸ Submission

Submit a screenshot for each of the following:

Your query and result for Task 1.
Your query and result for Task 2.
Your query and result for Task 3.
Your query and result for Task 4.